# 应用管理工具使用指南

## 📋 概述

`npm run db:manage-apps` 命令提供了一个完整的应用数据库管理工具，允许您查看、筛选、搜索、更新和删除应用数据。

---

## 🚀 快速开始

### 启动应用管理工具

```bash
npm run db:manage-apps
```

### 非交互模式（查看统计信息）

```bash
# 在非交互环境中，工具会自动显示统计信息后退出
echo "0" | npm run db:manage-apps
```

---

## 📱 功能菜单

启动工具后，您将看到以下菜单选项：

```
📱 应用数据库管理工具
==================================================
1. 查看所有应用
2. 查看应用详情
3. 按状态筛选应用
4. 按类型筛选应用
5. 按平台筛选应用
6. 搜索应用
7. 删除应用
8. 更新应用信息
9. 数据库统计信息
10. 查看数据库表结构
0. 退出
==================================================
```

---

## 🔧 功能详解

### 1. 查看所有应用

显示数据库中所有应用的列表，包括：
- 应用ID、名称、Slug
- 类型、平台、状态
- 体验方式、标签
- DAU、下载量、点赞数
- 创建时间和发布时间

### 2. 查看应用详情

输入应用ID查看详细信息，包括：
- 完整的应用信息
- 下载链接、二维码链接
- 封面图片、演示视频链接

### 3. 按状态筛选应用

支持按以下状态筛选：
- **online** (已上线)
- **beta** (测试版)
- **development** (开发中)

### 4. 按类型筛选应用

支持按以下类型筛选：
- **app** (应用)
- **miniprogram** (小程序)
- **game** (游戏)

### 5. 按平台筛选应用

支持按以下平台筛选：
- **web** (Web)
- **mobile** (移动端)
- **wechat** (微信)

### 6. 搜索应用

根据应用名称或描述进行关键词搜索，支持模糊匹配。

### 7. 删除应用

删除指定ID的应用，会同时删除所有相关数据。

**⚠️ 注意**: 删除操作不可恢复，请谨慎使用。

### 8. 更新应用信息

更新应用的以下信息：
- 名称
- 描述
- 状态
- DAU
- 下载量
- 趋势

### 9. 数据库统计信息

显示详细的统计信息：
- 应用总数
- 按状态/类型/平台统计
- 总体数据（总DAU、总下载量、总点赞数）
- 平均数据
- 最近创建的应用

### 10. 查看数据库表结构

显示 `apps` 表的结构信息，包括：
- 字段名称、数据类型
- 是否可空、默认值
- 相关表检查

---

## 📊 使用示例

### 查看所有应用

```bash
npm run db:manage-apps
# 选择 1
```

### 按状态筛选

```bash
npm run db:manage-apps
# 选择 3
# 选择 1 (查看已上线应用)
```

### 搜索应用

```bash
npm run db:manage-apps
# 选择 6
# 输入搜索关键词，如 "微信"
```

### 更新应用信息

```bash
npm run db:manage-apps
# 选择 8
# 输入应用ID
# 输入新的信息（留空保持不变）
```

---

## 🔍 输出示例

### 应用列表输出

```
📋 所有应用列表:
--------------------------------------------------
ID: 1
名称: 你的名字
Slug: your-name
类型: miniprogram | 平台: web | 状态: online
体验方式: qrcode
标签: 小程序, 微信
DAU: 0 | 下载量: 0 | 点赞数: 0
趋势: stable
创建时间: 2025-09-17T00:00:00.000Z
发布时间: 2025-09-17T00:00:00.000Z
--------------------------------------------------
总计: 1 个应用
```

### 统计信息输出

```
📊 应用数据库统计信息:
--------------------------------------------------
应用总数: 1

按状态统计:
  已上线: 1 个

按类型统计:
  小程序: 1 个

按平台统计:
  Web: 1 个

总体数据:
  总DAU: 0
  总下载量: 0
  总点赞数: 0
  平均DAU: 0
  平均下载量: 0
  平均点赞数: 0

最近创建的应用:
  - 你的名字 (miniprogram/web/online)
    DAU: 0 | 下载量: 0
    创建时间: 2025-09-17
```

---

## ⚠️ 注意事项

### 安全提示

1. **删除操作**: 删除应用会同时删除所有相关数据，操作不可恢复
2. **数据备份**: 重要操作前建议备份数据库
3. **权限控制**: 确保只有授权人员使用此工具

### 使用建议

1. **定期检查**: 定期查看统计信息，了解应用数据变化
2. **数据清理**: 及时删除不需要的应用数据
3. **状态管理**: 合理管理应用状态，确保数据准确性

### 故障排除

1. **数据库连接失败**: 检查 `.env.local` 文件中的数据库配置
2. **表不存在**: 运行 `npm run db:init` 初始化数据库
3. **权限不足**: 确保数据库用户有足够的权限

---

## 🔗 相关命令

```bash
# 数据库信息检查
npm run db:info

# 数据库初始化
npm run db:init

# 博客管理
npm run db:manage-blog

# AIGC内容管理
npm run db:manage-aigc-master
```

---

## 📚 相关文档

- **[数据库指南](./database-guide.md)** - 数据库使用指南
- **[数据库架构](./database-content-architecture.md)** - 数据库架构设计
- **[数据库表结构](./database-schema.md)** - 详细的表结构说明
