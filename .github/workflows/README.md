# CI/CD å·¥ä½œæµè¯´æ˜Ž

## ðŸ“‹ å½“å‰æž¶æž„æ¦‚è§ˆ âœ¨

### ðŸ”„ ç»Ÿä¸€Pipeline (`pipeline.yml`) - **æœ€æ–°æž¶æž„**
**èŒè´£**: CI/CDä¸€ä½“åŒ–ï¼Œå•ä¸€å·¥ä½œæµç®¡ç†å®Œæ•´æµç¨‹  
- **è§¦å‘**: 
  - Pushåˆ°mainã€developåˆ†æ”¯
  - æ‰‹åŠ¨è§¦å‘æ”¯æŒ (workflow_dispatch)
- **åŒ…å«**: 
  - **CIé˜¶æ®µ**: ESLint, TypeScript, Jestæµ‹è¯•, Next.jsæž„å»ºéªŒè¯
  - **ç”Ÿäº§éƒ¨ç½²**: mainåˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ
  - **å¼€å‘éƒ¨ç½²**: developåˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²åˆ°é¢„è§ˆçŽ¯å¢ƒ
  - **å¥åº·æ£€æŸ¥**: éƒ¨ç½²åŽçŠ¶æ€éªŒè¯å’Œæ±‡æ€»æŠ¥å‘Š

## âœ… æž¶æž„ä¼˜åŠ¿

### 1. **ç®€åŒ–æž¶æž„**
- âœ… **å•ä¸€å·¥ä½œæµ**: ä¸€ä¸ªæ–‡ä»¶ç®¡ç†CI+CDå…¨æµç¨‹
- âœ… **å‡å°‘ä¾èµ–**: æ— éœ€workflow_runè§¦å‘å™¨ï¼Œé¿å…secretsè®¿é—®é—®é¢˜
- âœ… **å¿«é€Ÿåé¦ˆ**: Pushå³è§¦å‘ï¼Œæ— ç­‰å¾…æ—¶é—´

### 2. **ç¨³å®šéƒ¨ç½²**
- âœ… **åŽŸç”ŸCLI**: æŠ›å¼ƒè¿‡æ—¶çš„vercel-actionï¼Œç›´æŽ¥ä½¿ç”¨æœ€æ–°Vercel CLI
- âœ… **éžäº¤äº’å¼**: ç®¡é“è¾“å…¥è‡ªåŠ¨ç¡®è®¤ï¼Œæ— å¡æ­»é—®é¢˜
- âœ… **æ™ºèƒ½æž„å»º**: ä½¿ç”¨æ— lintæž„å»ºè„šæœ¬ï¼Œé¿å…ESLintç‰ˆæœ¬å†²çª

### 3. **ç»´æŠ¤ç®€å•**
- âœ… **é…ç½®ç»Ÿä¸€**: æ‰€æœ‰CI/CDé€»è¾‘åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­
- âœ… **é—®é¢˜éš”ç¦»**: ä¾èµ–é—®é¢˜é€šè¿‡package-lock.jsonåŒæ­¥è§£å†³
- âœ… **ç‰ˆæœ¬å…¼å®¹**: è‡ªåŠ¨ä½¿ç”¨æœ€æ–°å·¥å…·ç‰ˆæœ¬

## ðŸ”„ å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[ä»£ç Push] --> B[è¿è¡ŒCIæµ‹è¯•]
    B --> C{CIé€šè¿‡?}
    C -->|æ˜¯| D{åˆ†æ”¯æ£€æŸ¥}
    C -->|å¦| E[ä»»åŠ¡å¤±è´¥]
    D -->|main| F[ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²]
    D -->|develop| G[å¼€å‘çŽ¯å¢ƒéƒ¨ç½²]
    F --> H[å‰ç«¯éƒ¨ç½²åˆ°Vercel]
    F --> I[åŽç«¯éƒ¨ç½²åˆ°Vercel]
    G --> J[å‰ç«¯é¢„è§ˆéƒ¨ç½²]
    G --> K[åŽç«¯é¢„è§ˆéƒ¨ç½²]
    H --> L[éƒ¨ç½²çŠ¶æ€æ±‡æ€»]
    I --> L
    J --> L
    K --> L
```

## ðŸŽ›ï¸ åˆ†æ”¯ç­–ç•¥

| åˆ†æ”¯ | CIè§¦å‘ | éƒ¨ç½²çŽ¯å¢ƒ | è¯´æ˜Ž |
|-----|--------|----------|------|
| `main` | âœ… | Production | ç”Ÿäº§çŽ¯å¢ƒè‡ªåŠ¨éƒ¨ç½² |
| `develop` | âœ… | Preview | é¢„è§ˆçŽ¯å¢ƒè‡ªåŠ¨éƒ¨ç½² |
| `feature/*` | âŒ | - | éœ€æ‰‹åŠ¨åˆå¹¶åˆ°develop |

## ðŸ”§ éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ

### Verceléƒ¨ç½²é…ç½®
```bash
# ç›´æŽ¥ä½¿ç”¨æœ€æ–°Vercel CLI
npm install -g vercel@latest

# éžäº¤äº’å¼éƒ¨ç½²ç­–ç•¥
echo "y" | vercel --prod --token "$VERCEL_TOKEN" --confirm || \
vercel --prod --token "$VERCEL_TOKEN" --force --yes 2>/dev/null || \
vercel --prod --token "$VERCEL_TOKEN" < /dev/null
```

### æž„å»ºä¼˜åŒ–
```json
// package.json
"vercel-build-no-lint": "rm -rf .next && ... npx next build"

// vercel.json  
"buildCommand": "npm run vercel-build-no-lint"
```

## ðŸ“Š ç›‘æŽ§å’Œè°ƒè¯•

### çŠ¶æ€æ£€æŸ¥
- åœ¨GitHub Actionsé¡µé¢æŸ¥çœ‹"CI/CD Pipeline"å·¥ä½œæµ
- æ‰€æœ‰é˜¶æ®µåœ¨ä¸€ä¸ªå·¥ä½œæµä¸­ï¼Œä¾¿äºŽç»Ÿä¸€ç›‘æŽ§

### å¸¸è§é—®é¢˜æŽ’æŸ¥
1. **CIå¤±è´¥**: æ£€æŸ¥ESLintã€æµ‹è¯•æˆ–æž„å»ºé”™è¯¯
2. **éƒ¨ç½²å¡æ­»**: å·²è§£å†³ï¼Œä½¿ç”¨ç®¡é“è¾“å…¥è‡ªåŠ¨ç¡®è®¤
3. **æž„å»ºå¤±è´¥**: å·²è§£å†³ï¼Œä½¿ç”¨æ— lintæž„å»ºè„šæœ¬
4. **ä¾èµ–å†²çª**: å·²è§£å†³ï¼Œpackage-lock.jsonå·²åŒæ­¥

## ðŸš¨ å·²è§£å†³çš„åŽ†å²é—®é¢˜

| é—®é¢˜ | åŽŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----|------|----------|
| workflow_runæ— æ³•è®¿é—®secrets | è§¦å‘å™¨é™åˆ¶ | æ”¹ç”¨pushè§¦å‘å™¨ |
| Vercel CLIäº¤äº’å¼å¡æ­» | vercel-actionç‰ˆæœ¬è¿‡æ—§ | ç›´æŽ¥ä½¿ç”¨æœ€æ–°CLI + ç®¡é“è¾“å…¥ |
| ESLintæž„å»ºå¤±è´¥ | ç‰ˆæœ¬ä¸åŒ¹é… | æ›´æ–°ä¾èµ– + æ— lintæž„å»ºè„šæœ¬ |
| npm ciå¤±è´¥ | lockæ–‡ä»¶ä¸ä¸€è‡´ | é‡æ–°ç”Ÿæˆpackage-lock.json |

## ðŸ”§ è‡ªå®šä¹‰é…ç½®

å¦‚éœ€ä¿®æ”¹éƒ¨ç½²æµç¨‹ï¼Œç¼–è¾‘ `pipeline.yml` æ–‡ä»¶ï¼š
- CIæ£€æŸ¥é…ç½®: jobs.run-ci
- ç”Ÿäº§éƒ¨ç½²é…ç½®: jobs.deploy-production  
- å¼€å‘éƒ¨ç½²é…ç½®: jobs.deploy-development