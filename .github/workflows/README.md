# CI/CD å·¥ä½œæµè¯´æ˜Ž

## ðŸ“‹ å½“å‰æž¶æž„æ¦‚è§ˆ âœ¨

### ðŸ”„ ç»Ÿä¸€Pipeline (`pipeline.yml`) - **æœ€æ–°æž¶æž„**
**èŒè´£**: CI/CDä¸€ä½“åŒ–ï¼Œå•ä¸€å·¥ä½œæµç®¡ç†å®Œæ•´æµç¨‹  
- **è§¦å‘**: 
  - Pushåˆ°mainã€developåˆ†æ”¯
  - æ‰‹åŠ¨è§¦å‘æ”¯æŒ (workflow_dispatch)
- **åŒ…å«**: 
  - **CIé˜¶æ®µ**: ESLint, TypeScript, Jestæµ‹è¯•, Next.jsæž„å»ºéªŒè¯
  - **ç”Ÿäº§éƒ¨ç½²**: mainåˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ
  - **å¼€å‘éƒ¨ç½²**: developåˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²åˆ°é¢„è§ˆçŽ¯å¢ƒ
  - **å¥åº·æ£€æŸ¥**: éƒ¨ç½²åŽçŠ¶æ€éªŒè¯å’Œæ±‡æ€»æŠ¥å‘Š

## âœ… æž¶æž„ä¼˜åŠ¿

### 1. **ç®€åŒ–æž¶æž„**
- âœ… **å•ä¸€å·¥ä½œæµ**: ä¸€ä¸ªæ–‡ä»¶ç®¡ç†CI+CDå…¨æµç¨‹
- âœ… **å‡å°‘ä¾èµ–**: æ— éœ€workflow_runè§¦å‘å™¨ï¼Œé¿å…secretsè®¿é—®é—®é¢˜
- âœ… **å¿«é€Ÿåé¦ˆ**: Pushå³è§¦å‘ï¼Œæ— ç­‰å¾…æ—¶é—´

### 2. **ç¨³å®šéƒ¨ç½²**
- âœ… **åŽŸç”ŸCLI**: æŠ›å¼ƒè¿‡æ—¶çš„vercel-actionï¼Œç›´æŽ¥ä½¿ç”¨æœ€æ–°Vercel CLI
- âœ… **éžäº¤äº’å¼**: ç®¡é“è¾“å…¥è‡ªåŠ¨ç¡®è®¤ï¼Œæ— å¡æ­»é—®é¢˜
- âœ… **æ™ºèƒ½æž„å»º**: ä½¿ç”¨æ— lintæž„å»ºè„šæœ¬ï¼Œé¿å…ESLintç‰ˆæœ¬å†²çª

### 3. **ç»´æŠ¤ç®€å•**
- âœ… **é…ç½®ç»Ÿä¸€**: æ‰€æœ‰CI/CDé€»è¾‘åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­
- âœ… **é—®é¢˜éš”ç¦»**: ä¾èµ–é—®é¢˜é€šè¿‡package-lock.jsonåŒæ­¥è§£å†³
- âœ… **ç‰ˆæœ¬å…¼å®¹**: è‡ªåŠ¨ä½¿ç”¨æœ€æ–°å·¥å…·ç‰ˆæœ¬

## ðŸ”„ å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[ä»£ç Push] --> B[è¿è¡ŒCIæµ‹è¯•]
    B --> C{CIé€šè¿‡?}
    C -->|æ˜¯| D{åˆ†æ”¯æ£€æŸ¥}
    C -->|å¦| E[ä»»åŠ¡å¤±è´¥]
    D -->|main| F[ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²]
    D -->|develop| G[å¼€å‘çŽ¯å¢ƒéƒ¨ç½²]
    F --> H[å‰ç«¯éƒ¨ç½²åˆ°Vercel]
    F --> I[åŽç«¯éƒ¨ç½²åˆ°Vercel]
    G --> J[å‰ç«¯é¢„è§ˆéƒ¨ç½²]
    G --> K[åŽç«¯é¢„è§ˆéƒ¨ç½²]
    H --> L[éƒ¨ç½²çŠ¶æ€æ±‡æ€»]
    I --> L
    J --> L
    K --> L
```

## ðŸŽ›ï¸ åˆ†æ”¯ç­–ç•¥

| åˆ†æ”¯ | CIè§¦å‘ | éƒ¨ç½²çŽ¯å¢ƒ | è¯´æ˜Ž |
|-----|--------|----------|------|
| `main` | âœ… | Production | ç”Ÿäº§çŽ¯å¢ƒè‡ªåŠ¨éƒ¨ç½² |
| `develop` | âœ… | Preview | é¢„è§ˆçŽ¯å¢ƒè‡ªåŠ¨éƒ¨ç½² |
| `feature/*` | âŒ | - | éœ€æ‰‹åŠ¨åˆå¹¶åˆ°develop |

## ðŸ”§ éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ

### Verceléƒ¨ç½²é…ç½®
```bash
# ç›´æŽ¥ä½¿ç”¨æœ€æ–°Vercel CLI
npm install -g vercel@latest

# éžäº¤äº’å¼éƒ¨ç½²ç­–ç•¥
echo "y" | vercel --prod --token "$VERCEL_TOKEN" --confirm || \
vercel --prod --token "$VERCEL_TOKEN" --force --yes 2>/dev/null || \
vercel --prod --token "$VERCEL_TOKEN" < /dev/null
```

### æž„å»ºä¼˜åŒ–
```json
// package.json
"vercel-build-no-lint": "rm -rf .next && ... npx next build"

// vercel.json  
"buildCommand": "npm run vercel-build-no-lint"
```

## ðŸ“Š ç›‘æŽ§å’Œè°ƒè¯•

### çŠ¶æ€æ£€æŸ¥
- åœ¨GitHub Actionsé¡µé¢æŸ¥çœ‹"CI/CD Pipeline"å·¥ä½œæµ
- æ‰€æœ‰é˜¶æ®µåœ¨ä¸€ä¸ªå·¥ä½œæµä¸­ï¼Œä¾¿äºŽç»Ÿä¸€ç›‘æŽ§

### å¸¸è§é—®é¢˜æŽ’æŸ¥
1. **CIå¤±è´¥**: æ£€æŸ¥ESLintã€æµ‹è¯•æˆ–æž„å»ºé”™è¯¯
2. **éƒ¨ç½²å¡æ­»**: å·²è§£å†³ï¼Œä½¿ç”¨ç®¡é“è¾“å…¥è‡ªåŠ¨ç¡®è®¤
3. **æž„å»ºå¤±è´¥**: å·²è§£å†³ï¼Œä½¿ç”¨æ— lintæž„å»ºè„šæœ¬
4. **ä¾èµ–å†²çª**: å·²è§£å†³ï¼Œpackage-lock.jsonå·²åŒæ­¥

## ðŸš¨ å·²è§£å†³çš„åŽ†å²é—®é¢˜

| é—®é¢˜ | åŽŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----|------|----------|
| workflow_runæ— æ³•è®¿é—®secrets | è§¦å‘å™¨é™åˆ¶ | æ”¹ç”¨pushè§¦å‘å™¨ |
| Vercel CLIäº¤äº’å¼å¡æ­» | vercel-actionç‰ˆæœ¬è¿‡æ—§ | ç›´æŽ¥ä½¿ç”¨æœ€æ–°CLI + ç®¡é“è¾“å…¥ |
| ESLintæž„å»ºå¤±è´¥ | ç‰ˆæœ¬ä¸åŒ¹é… | æ›´æ–°ä¾èµ– + æ— lintæž„å»ºè„šæœ¬ |
| npm ciå¤±è´¥ | lockæ–‡ä»¶ä¸ä¸€è‡´ | é‡æ–°ç”Ÿæˆpackage-lock.json |

## ðŸ”® è®¡åˆ’ä¸­çš„åŠŸèƒ½æ‰©å±•

### Code Quality æ ¸å¿ƒç±»åˆ« (å¾…å®žçŽ°)

#### **1. ä»£ç è§„èŒƒä¸Žæ ¼å¼åŒ–**
```yaml
å‰ç«¯ (JavaScript/TypeScript):
â”œâ”€â”€ ESLint          # ä»£ç è§„èŒƒæ£€æŸ¥ âœ… (å·²æœ‰)
â”œâ”€â”€ Prettier        # ä»£ç æ ¼å¼åŒ–
â”œâ”€â”€ TypeScript      # ç±»åž‹æ£€æŸ¥ âœ… (å·²æœ‰)
â””â”€â”€ Stylelint       # CSS/SCSSè§„èŒƒ

åŽç«¯ (Python):
â”œâ”€â”€ Black           # ä»£ç æ ¼å¼åŒ–
â”œâ”€â”€ Flake8          # PEP8è§„èŒƒæ£€æŸ¥
â”œâ”€â”€ isort           # importæŽ’åº
â”œâ”€â”€ MyPy            # ç±»åž‹æ£€æŸ¥
â””â”€â”€ pylint          # ç»¼åˆä»£ç è´¨é‡
```

#### **2. å•å…ƒæµ‹è¯•ä¸Žè¦†ç›–çŽ‡**
```yaml
æµ‹è¯•æ¡†æž¶:
â”œâ”€â”€ Jest            # å‰ç«¯å•å…ƒæµ‹è¯• âœ… (å·²æœ‰)
â”œâ”€â”€ PyTest          # åŽç«¯å•å…ƒæµ‹è¯•
â”œâ”€â”€ React Testing   # ç»„ä»¶æµ‹è¯•
â””â”€â”€ Supertest       # APIæµ‹è¯•

è¦†ç›–çŽ‡è¦æ±‚:
â”œâ”€â”€ æœ€ä½Žè¦†ç›–çŽ‡      # é€šå¸¸70-80%
â”œâ”€â”€ åˆ†æ”¯è¦†ç›–        # é€»è¾‘åˆ†æ”¯æµ‹è¯•
â””â”€â”€ è¦†ç›–çŽ‡æŠ¥å‘Š      # ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
```

#### **3. å®‰å…¨æ‰«æ**
```yaml
ä¾èµ–å®‰å…¨:
â”œâ”€â”€ npm audit       # Node.jsä¾èµ–æ¼æ´ž
â”œâ”€â”€ yarn audit      # Yarnä¾èµ–æ£€æŸ¥
â”œâ”€â”€ safety          # Pythonä¾èµ–å®‰å…¨
â””â”€â”€ snyk            # è·¨å¹³å°ä¾èµ–æ‰«æ

ä»£ç å®‰å…¨:
â”œâ”€â”€ bandit          # Pythonå®‰å…¨æ‰«æ
â”œâ”€â”€ semgrep         # å¤šè¯­è¨€å®‰å…¨åˆ†æž
â”œâ”€â”€ CodeQL          # GitHubé«˜çº§å®‰å…¨
â””â”€â”€ SonarQube       # ç»¼åˆå®‰å…¨åˆ†æž

å¯†é’¥æ³„éœ²:
â”œâ”€â”€ gitleaks        # GitåŽ†å²å¯†é’¥æ‰«æ
â”œâ”€â”€ truffleHog      # å¯†é’¥æ¨¡å¼åŒ¹é…
â””â”€â”€ detect-secrets  # é¢„æäº¤å¯†é’¥æ£€æŸ¥
```

#### **4. æ€§èƒ½ä¸Žè´¨é‡æŒ‡æ ‡**
```yaml
æ€§èƒ½æµ‹è¯•:
â”œâ”€â”€ Lighthouse CI   # Webæ€§èƒ½åŸºå‡†
â”œâ”€â”€ Bundle Analyzer # æ‰“åŒ…ä½“ç§¯åˆ†æž
â”œâ”€â”€ Core Web Vitals # ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
â””â”€â”€ Load Testing    # è´Ÿè½½æµ‹è¯•

ä»£ç è´¨é‡:
â”œâ”€â”€ å¤æ‚åº¦åˆ†æž       # åœˆå¤æ‚åº¦
â”œâ”€â”€ é‡å¤ä»£ç æ£€æµ‹     # DRYåŽŸåˆ™
â”œâ”€â”€ æŠ€æœ¯å€ºåŠ¡è¯„ä¼°     # ç»´æŠ¤æ€§æŒ‡æ ‡
â””â”€â”€ æ–‡æ¡£è¦†ç›–çŽ‡       # æ³¨é‡Šå®Œæ•´æ€§
```

#### **5. è®¸å¯è¯ä¸Žåˆè§„æ€§**
```yaml
è®¸å¯è¯æ£€æŸ¥:
â”œâ”€â”€ license-checker # ä¾èµ–è®¸å¯è¯æ‰«æ
â”œâ”€â”€ FOSSA          # ä¼ä¸šçº§è®¸å¯è¯ç®¡ç†
â”œâ”€â”€ å¼€æºåˆè§„       # GPL/MITç­‰å…¼å®¹æ€§
â””â”€â”€ æ³•å¾‹é£Žé™©è¯„ä¼°   # å•†ä¸šä½¿ç”¨é£Žé™©
```

### å®žçŽ°æ–¹æ¡ˆ
- **é˜¶æ®µ1**: åŸºç¡€å®‰å…¨æ‰«æ (npm audit + gitleaks)
- **é˜¶æ®µ2**: æ€§èƒ½ç›‘æŽ§ (Lighthouse CI)
- **é˜¶æ®µ3**: åŽç«¯è´¨é‡æ£€æŸ¥ (Pythonå·¥å…·é“¾)
- **é˜¶æ®µ4**: é«˜çº§å®‰å…¨åˆ†æž (semgrep + CodeQL)

---

## ðŸ”§ è‡ªå®šä¹‰é…ç½®

å¦‚éœ€ä¿®æ”¹éƒ¨ç½²æµç¨‹ï¼Œç¼–è¾‘ `pipeline.yml` æ–‡ä»¶ï¼š
- CIæ£€æŸ¥é…ç½®: jobs.run-ci
- ç”Ÿäº§éƒ¨ç½²é…ç½®: jobs.deploy-production  
- å¼€å‘éƒ¨ç½²é…ç½®: jobs.deploy-development