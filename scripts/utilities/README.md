# Utilities Scripts

å·¥å…·ç±»è„šæœ¬ï¼ŒåŒ…å«å„ç§å®ç”¨å·¥å…·å’Œè¾…åŠ©è„šæœ¬ã€‚

## ğŸ“‹ è„šæœ¬åˆ—è¡¨

### ğŸ–¼ï¸ èµ„æºç®¡ç†

#### `update-avatar.sh`

- **ç”¨é€”**: æ›´æ–°å¤´åƒè„šæœ¬
- **åŠŸèƒ½**:
  - æ‰¹é‡æ›´æ–°ç”¨æˆ·å¤´åƒ
  - å¤„ç†å¤´åƒæ ¼å¼è½¬æ¢
  - ä¼˜åŒ–å¤´åƒå°ºå¯¸
- **ä½¿ç”¨åœºæ™¯**: å¤´åƒèµ„æºæ›´æ–°ç»´æŠ¤
- **å‘½ä»¤**: `./scripts/utilities/update-avatar.sh`

### ğŸ“ æ–‡æ¡£ç®¡ç†

#### `update-changelog.ts` â­ **å¸¸ç”¨**

- **ç”¨é€”**: æ›´æ–°å˜æ›´æ—¥å¿—å·¥å…·
- **åŠŸèƒ½**:
  - è‡ªåŠ¨ç”Ÿæˆå˜æ›´æ—¥å¿—æ¡ç›®
  - æ”¯æŒå¤šç§å˜æ›´ç±»å‹
  - æ ¼å¼åŒ–æ—¥å¿—è¾“å‡º
  - æŒ‰æ—¶é—´æ’åº
- **ä½¿ç”¨åœºæ™¯**: ç‰ˆæœ¬å‘å¸ƒå‰æ›´æ–°CHANGELOG
- **å‘½ä»¤**: `npx tsx scripts/utilities/update-changelog.ts`

**ä½¿ç”¨ç¤ºä¾‹**:

```bash
# æ·»åŠ æ–°åŠŸèƒ½
npm run changelog -- --type=feat --message="æ–°å¢è§†é¢‘æ’­æ”¾å™¨åŠŸèƒ½"

# ä¿®å¤é—®é¢˜
npm run changelog -- --type=fix --message="ä¿®å¤éŸ³ä¹æ’­æ”¾å™¨çŠ¶æ€åŒæ­¥é—®é¢˜"

# æ€§èƒ½ä¼˜åŒ–
npm run changelog -- --type=change --message="ä¼˜åŒ–é¦–é¡µåŠ è½½æ€§èƒ½"
```

### ğŸ”§ Gitå·¥å…·

#### `git-hooks/pre-commit`

- **ç”¨é€”**: Gitæäº¤å‰é’©å­
- **åŠŸèƒ½**:
  - ä»£ç æ ¼å¼æ£€æŸ¥
  - è¯­æ³•æ£€æŸ¥
  - æµ‹è¯•è¿è¡Œ
  - æäº¤ä¿¡æ¯éªŒè¯
- **ä½¿ç”¨åœºæ™¯**: è‡ªåŠ¨åŒ–ä»£ç è´¨é‡æ£€æŸ¥
- **å®‰è£…**:
  ```bash
  cp scripts/utilities/git-hooks/pre-commit .git/hooks/
  chmod +x .git/hooks/pre-commit
  ```

## ğŸ› ï¸ å·¥å…·ä½¿ç”¨æŒ‡å—

### å˜æ›´æ—¥å¿—ç®¡ç†

#### æ”¯æŒçš„å˜æ›´ç±»å‹

- `feat` - æ–°åŠŸèƒ½
- `fix` - é—®é¢˜ä¿®å¤
- `change` - åŠŸèƒ½æ”¹è¿›
- `remove` - åŠŸèƒ½ç§»é™¤
- `security` - å®‰å…¨ç›¸å…³

#### ä½¿ç”¨æµç¨‹

```bash
# 1. å¼€å‘å®Œæˆåï¼Œæ·»åŠ å˜æ›´è®°å½•
npm run changelog -- --type=feat --message="æ–°å¢ç”¨æˆ·ç®¡ç†åŠŸèƒ½"

# 2. æŸ¥çœ‹ç”Ÿæˆçš„CHANGELOG.md
cat CHANGELOG.md

# 3. æäº¤å˜æ›´
git add CHANGELOG.md
git commit -m "docs: update changelog"
```

#### æ‰¹é‡æ·»åŠ å˜æ›´

```bash
# å¯ä»¥è¿ç»­æ·»åŠ å¤šä¸ªå˜æ›´
npm run changelog -- --type=feat --message="æ–°å¢æœç´¢åŠŸèƒ½"
npm run changelog -- --type=fix --message="ä¿®å¤åˆ†é¡µé—®é¢˜"
npm run changelog -- --type=change --message="ä¼˜åŒ–ç•Œé¢å“åº”é€Ÿåº¦"
```

### Gité’©å­é…ç½®

#### å®‰è£…é¢„æäº¤é’©å­

```bash
# å¤åˆ¶é’©å­æ–‡ä»¶
cp scripts/utilities/git-hooks/pre-commit .git/hooks/

# è®¾ç½®æ‰§è¡Œæƒé™
chmod +x .git/hooks/pre-commit
```

#### é’©å­åŠŸèƒ½

- **ä»£ç æ ¼å¼åŒ–**: è‡ªåŠ¨è¿è¡Œ Prettier
- **è¯­æ³•æ£€æŸ¥**: è¿è¡Œ ESLint æ£€æŸ¥
- **ç±»å‹æ£€æŸ¥**: è¿è¡Œ TypeScript ç¼–è¯‘æ£€æŸ¥
- **æµ‹è¯•**: è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰

#### è·³è¿‡é’©å­

```bash
# ç´§æ€¥æƒ…å†µä¸‹è·³è¿‡é’©å­
git commit --no-verify -m "emergency fix"
```

### å¤´åƒç®¡ç†

#### æ›´æ–°å¤´åƒ

```bash
# è¿è¡Œå¤´åƒæ›´æ–°è„šæœ¬
./scripts/utilities/update-avatar.sh

# æŒ‡å®šå¤´åƒæ–‡ä»¶
./scripts/utilities/update-avatar.sh /path/to/new-avatar.png
```

#### æ”¯æŒæ ¼å¼

- PNG (æ¨è)
- JPG/JPEG
- WebP
- SVG

## ğŸ”§ é…ç½®è¯´æ˜

### update-changelog.ts é…ç½®

è„šæœ¬ä¼šè¯»å–ä»¥ä¸‹é…ç½®ï¼š

- å˜æ›´æ—¥å¿—æ–‡ä»¶è·¯å¾„: `CHANGELOG.md`
- æ—¥æœŸæ ¼å¼: `YYYY-MM-DD`
- ç‰ˆæœ¬æ ¼å¼: è‡ªåŠ¨é€’å¢

### Gité’©å­é…ç½®

å¯ä»¥åœ¨ `.git/hooks/pre-commit` ä¸­è‡ªå®šä¹‰ï¼š

```bash
#!/bin/sh
# è‡ªå®šä¹‰é¢„æäº¤æ£€æŸ¥
npm run lint
npm run type-check
npm run test:unit
```

## ğŸ“ ç»´æŠ¤æŒ‡å—

### å®šæœŸç»´æŠ¤ä»»åŠ¡

#### æ¯å‘¨

- æ£€æŸ¥å¹¶æ›´æ–°å˜æ›´æ—¥å¿—
- æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- æ›´æ–°å·¥å…·è„šæœ¬

#### æ¯æœˆ

- æ£€æŸ¥Gité’©å­æ˜¯å¦æ­£å¸¸å·¥ä½œ
- æ›´æ–°å·¥å…·ä¾èµ–
- æ¸…ç†è¿‡æœŸçš„å·¥å…·è„šæœ¬

#### ç‰ˆæœ¬å‘å¸ƒå‰

- æ•´ç†å˜æ›´æ—¥å¿—
- æ£€æŸ¥æ‰€æœ‰å·¥å…·è„šæœ¬
- æ›´æ–°ç‰ˆæœ¬ä¿¡æ¯

### æ·»åŠ æ–°å·¥å…·

#### åˆ›å»ºæ–°è„šæœ¬

1. åœ¨ `scripts/utilities/` ç›®å½•åˆ›å»ºè„šæœ¬
2. æ·»åŠ é€‚å½“çš„æ–‡æ¡£æ³¨é‡Š
3. è®¾ç½®æ‰§è¡Œæƒé™
4. æ›´æ–°READMEæ–‡æ¡£

#### è„šæœ¬æ¨¡æ¿

```typescript
#!/usr/bin/env ts-node

/**
 * å·¥å…·åç§°
 * ç”¨é€”è¯´æ˜
 * ä½¿ç”¨æ–¹æ³•ï¼šnpx tsx scripts/utilities/your-tool.ts
 */

import * as dotenv from "dotenv";
dotenv.config({ path: ".env.local" });

async function main() {
  try {
    console.log("ğŸš€ å·¥å…·å¯åŠ¨...");

    // å·¥å…·é€»è¾‘

    console.log("âœ… å·¥å…·æ‰§è¡Œå®Œæˆ");
  } catch (error) {
    console.error("âŒ å·¥å…·æ‰§è¡Œå¤±è´¥:", error);
    process.exit(1);
  }
}

main();
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æƒé™**: æŸäº›å·¥å…·å¯èƒ½éœ€è¦æ–‡ä»¶ç³»ç»Ÿæƒé™
2. **å¤‡ä»½**: è¿è¡Œä¿®æ”¹æ–‡ä»¶çš„å·¥å…·å‰è¯·å¤‡ä»½
3. **æµ‹è¯•**: æ–°å·¥å…·è¦åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
4. **æ–‡æ¡£**: åŠæ—¶æ›´æ–°å·¥å…·æ–‡æ¡£

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å¼€å‘æŒ‡å—](../../docs/development-guide.md)
- [Gitå·¥ä½œæµ](../../docs/git-workflow.md)
- [å˜æ›´æ—¥å¿—æŒ‡å—](../../docs/changelog-guide.md)
